doctype html
html(lang="en")
  head
    title= pageTitle
    script(src='https://code.jquery.com/jquery-3.3.1.min.js', integrity='sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=', crossorigin='anonymous')
    script(src='https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/js/bootstrap.min.js')
    link(rel='stylesheet', href='https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/css/bootstrap.min.css')
  body
  style.
    body{

      font-family:Arial;
    }
    #map {
      width: 75%;
      height: 800px;
      float:left;
    }
    #navigation {
      width: 25%;
      height: 800px;
      background-color:white;
      float:right;

      text-transform: uppercase;
      padding-left:1%;
      padding-right:1%;
      padding-top:1%;
      overflow:scroll;
    }

    #latlng {
      display:block;
      color:grey;
      margin-top:1%;
      margin-bottom:2%;
    }

    H1{
      font-size:14pt;
      font-weight:bold;
    }
    .detailname {
      display:block;
      font-size:12pt;
      width:100%;
      clear:both;
      margin-bottom:20px;
      font-weight:bold;
    }

    .detailaddress {
      display:block;
      font-size:12pt;
      width:100%;
      clear:both;
      margin-bottom:20px;
    }

    .detaildescription {
      display:block;
      font-size:12pt;
      width:100%;
      clear:both;
      margin-bottom:20px;
    }

    .detailpostcode {
      display:block;
      font-size:12pt;
      width:100%;
      clear:both;
      margin-bottom:20px;
    }

    label{


    }

    .detailblock {
    margin-bottom:20px;
    }

    .form-control{
    margin-bottom:5px;
    }

    .btn{
    margin-right:1%;
    margin-top:3%;
    }





  #map
  #navigation
    H1 Macclesfield Memory Project
    hr
    div.inputblock
      form(method='post', enctype='multipart/form-data', action='postitem')
        div.form-group
          input#lat.form-control(name='lat')
          input#lng.form-control(name='lng')
          label(for='name') Title:
          input#name.form-control(name='name')
          label(for='description') Description:
          textarea.form-control(name="description", cols="40", rows="5")
          label(for='pointType') Type:
          select#pointType.select.form-control.input-lg(name='pointType')
            option(value='0') -- Select --
            option(value='story') Story
            option(value='audio') Audio
            option(value='film') Film
          input.form-control-file(type='file', name='uploadfile')
          label(for='address') Address:
          input#address.form-control(name='address')
          label(for='postcode') Postcode:
          input#postcode.form-control(name='postcode')
          input.btn.btn-primary(type='submit', value='post')
          input.btn.btn-danger(type='submit', value='cancel')

    div#image
    div.detailblock
      div.detailname
      div.detaildescription
      div.detailaddress
      div.detailpostcode
    div.messageblock
      div.message
  script.
    var map;
    var dataPoints = !{data};
    var message = !{message};

    $( document ).ready(function() {
      $(".inputblock").hide();
      $('.detailblock').hide();
      $('.detailblock').hide();

      if(message != '-')
      {
        $('.detailblock').show();
        $('.message').html(message);
      }
    });

    var iconBase = 'http://localhost:8082/';
        var icons = {
          story: {
            icon: iconBase + 'story.png'
          },
          audio: {
            icon: iconBase + 'audio.png'
          },
          film: {
            icon: iconBase + 'film.png'
          }
        };

    function initMap() {
      map = new google.maps.Map(document.getElementById('map'), {
        center: { lat: 53.2587, lng: -2.1193 },
        zoom: 15,
        mapTypeControl: false,
        streetViewControl: false,
        styles: [{
        "featureType": "administrative",
        "elementType": "labels.text.fill",
        "stylers": [
            {
                "color": "#6195a0"
            }
        ]
    },
    {
        "featureType": "administrative.province",
        "elementType": "geometry.stroke",
        "stylers": [
            {
                "visibility": "off"
            }
        ]
    },
    {
        "featureType": "landscape",
        "elementType": "geometry",
        "stylers": [
            {
                "lightness": "0"
            },
            {
                "saturation": "0"
            },
            {
                "color": "#f5f5f2"
            },
            {
                "gamma": "1"
            }
        ]
    },
    {
        "featureType": "landscape.man_made",
        "elementType": "all",
        "stylers": [
            {
                "lightness": "-3"
            },
            {
                "gamma": "1.00"
            }
        ]
    },
    {
        "featureType": "landscape.natural.terrain",
        "elementType": "all",
        "stylers": [
            {
                "visibility": "off"
            }
        ]
    },
    {
        "featureType": "poi",
        "elementType": "all",
        "stylers": [
            {
                "visibility": "off"
            }
        ]
    },
    {
        "featureType": "poi.park",
        "elementType": "geometry.fill",
        "stylers": [
            {
                "color": "#bae5ce"
            },
            {
                "visibility": "on"
            }
        ]
    },
    {
        "featureType": "road",
        "elementType": "all",
        "stylers": [
            {
                "saturation": -100
            },
            {
                "lightness": 45
            },
            {
                "visibility": "simplified"
            }
        ]
    },
    {
        "featureType": "road.highway",
        "elementType": "all",
        "stylers": [
            {
                "visibility": "simplified"
            }
        ]
    },
    {
        "featureType": "road.highway",
        "elementType": "geometry.fill",
        "stylers": [
            {
                "color": "#fac9a9"
            },
            {
                "visibility": "simplified"
            }
        ]
    },
    {
        "featureType": "road.highway",
        "elementType": "labels.text",
        "stylers": [
            {
                "color": "#4e4e4e"
            }
        ]
    },
    {
        "featureType": "road.arterial",
        "elementType": "labels.text.fill",
        "stylers": [
            {
                "color": "#787878"
            }
        ]
    },
    {
        "featureType": "road.arterial",
        "elementType": "labels.icon",
        "stylers": [
            {
                "visibility": "off"
            }
        ]
    },
    {
        "featureType": "transit",
        "elementType": "all",
        "stylers": [
            {
                "visibility": "off"
            }
        ]
    },
    {
        "featureType": "transit.station.airport",
        "elementType": "labels.icon",
        "stylers": [
            {
                "hue": "#0a00ff"
            },
            {
                "saturation": "-77"
            },
            {
                "gamma": "0.57"
            },
            {
                "lightness": "0"
            }
        ]
    },
    {
        "featureType": "transit.station.rail",
        "elementType": "labels.text.fill",
        "stylers": [
            {
                "color": "#43321e"
            }
        ]
    },
    {
        "featureType": "transit.station.rail",
        "elementType": "labels.icon",
        "stylers": [
            {
                "hue": "#ff6c00"
            },
            {
                "lightness": "4"
            },
            {
                "gamma": "0.75"
            },
            {
                "saturation": "-68"
            }
        ]
    },
    {
        "featureType": "water",
        "elementType": "all",
        "stylers": [
            {
                "color": "#eaf6f8"
            },
            {
                "visibility": "on"
            }
        ]
    },
    {
        "featureType": "water",
        "elementType": "geometry.fill",
        "stylers": [
            {
                "color": "#c7eced"
            }
        ]
    },
    {
        "featureType": "water",
        "elementType": "labels.text.fill",
        "stylers": [
            {
                "lightness": "-49"
            },
            {
                "saturation": "-53"
            },
            {
                "gamma": "0.79"
            }
        ]
    }]
      });



      google.maps.event.addListener(map, 'click', function(event) {
        //placeMarker(event.latLng);


        console.log()
        document.getElementById("lat").value = event.latLng.toString().replace("(", "").replace(")", "").replace(" ", "").split(",")[0];
        document.getElementById("lng").value = event.latLng.toString().replace("(", "").replace(")", "").replace(" ", "").split(",")[1];
        $(".inputblock").show();
        $('.detailblock').hide();
        $('.detailblock').hide();
        });

        function placeMarker(location) {
          var marker = new google.maps.Marker({
          position: location,
          map: map
          });
        }

      if(dataPoints.length > 0)
      {
      dataPoints.forEach(function(sc) {
        var marker = new google.maps.Marker({
          position: new google.maps.LatLng(sc._source.location.lat, sc._source.location.lon),
          icon: icons[sc._source.type].icon,
          map: map,
          id: sc.id,
          title: sc._source.name,
          address : sc._source.address,
          postcode: sc._source.postcode,
          description : sc._source.description,
          earlylife : sc._source.earlylife,
          commemoration : sc._source.commemoration,
          animation: google.maps.Animation.DROP
        });

        marker.addListener('click', function() {

          $(".messageblock").hide();
          $('.inputblock').hide();
          $('.detailblock').show();

          $(".detailname").html(marker.title);
          $(".detailaddress").html(marker.address);
          $(".detailpostcode").html(marker.postcode);
          $(".detaildescription").html(marker.description);

        });


      });
    }
    }

  script(async defer src=`https://maps.googleapis.com/maps/api/js?key=AIzaSyCCOF6ZQcNeu0fIkG7dtwABPv3creQWcYM&callback=initMap`)
